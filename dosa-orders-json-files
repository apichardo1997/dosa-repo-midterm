import json
from collections import defaultdict


def read_orders(file_name):
    """Reads the JSON orders from the specified file."""
    with open(file_name, 'r') as file:
        orders = json.load(file)
    return orders

if __name__ == "__main__":
    import sys
    if len(sys.argv) != 2:
        print("Usage: python dosa_orders.py <orders.json>")
        sys.exit(1)

    orders_file = sys.argv[1]
    orders = read_orders(orders_file)
    print(orders)

def create_customers_json(orders, output_file="customers.json"):
    """Creates a JSON file containing customers' phone numbers as keys and names as values."""
    customers = {}
    for order in orders:
        phone_number = order["phone"]
        customer_name = order["name"]
        customers[phone_number] = customer_name

    with open(output_file, 'w') as file:
        json.dump(customers, file, indent=4)


def create_items_json(orders, output_file="items.json"):
    """Creates a JSON file containing item names as keys and an object with price and number of times ordered as values."""
    items = defaultdict(lambda: {"price": 0, "orders": 0})
    for order in orders:
        for item in order["items"]:
            item_name = item["name"]
            items[item_name]["price"] = item["price"]
            items[item_name]["orders"] += 1

    with open(output_file, 'w') as file:
        json.dump(items, file, indent=4)

    print(f"{output_file} created successfully!")

    print(f"{output_file} created successfully!")
